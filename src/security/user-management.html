<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Management & Security - College ERP</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #9c27b0 0%, #7b1fa2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .content {
            padding: 40px;
        }
        
        .tabs {
            display: flex;
            border-bottom: 2px solid #e9ecef;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .tab {
            padding: 15px 30px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            color: #666;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            color: #9c27b0;
            border-bottom: 3px solid #9c27b0;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .form-section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 1px solid #e9ecef;
        }
        
        .form-section h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.3em;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #9c27b0;
            box-shadow: 0 0 0 3px rgba(156, 39, 176, 0.1);
        }
        
        .btn {
            background: linear-gradient(135deg, #9c27b0 0%, #7b1fa2 100%);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(156, 39, 176, 0.3);
        }
        
        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #218838 100%);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%);
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .table th,
        .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }
        
        .table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
        }
        
        .table tr:hover {
            background: #f8f9fa;
        }
        
        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-active {
            background: #d4edda;
            color: #155724;
        }
        
        .status-inactive {
            background: #f8d7da;
            color: #721c24;
        }
        
        .role-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            background: #e9ecef;
            color: #495057;
        }
        
        .permissions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .permission-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #e9ecef;
            text-align: center;
        }
        
        .permission-item.enabled {
            border-color: #28a745;
            background: #f8fff8;
        }
        
        .permission-item.disabled {
            border-color: #dc3545;
            background: #fff8f8;
        }
        
        .permission-title {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .permission-description {
            font-size: 0.9em;
            color: #666;
        }
        
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }
        
        .alert.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .alert.warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #9c27b0;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .security-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-left: 5px solid #9c27b0;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #9c27b0;
            margin-bottom: 10px;
        }
        
        .stat-label {
            color: #666;
            font-weight: 600;
        }
        
        .login-form {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .login-title {
            text-align: center;
            margin-bottom: 30px;
            color: #333;
        }
        
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .container {
                margin: 10px;
            }
            
            .content {
                padding: 20px;
            }
            
            .permissions-grid {
                grid-template-columns: 1fr;
            }
            
            .security-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîê User Management & Security</h1>
            <p>Comprehensive user access control and security management</p>
        </div>
        
        <div class="content">
            <div class="alert" id="alert"></div>
            
            <!-- Login Section (if not authenticated) -->
            <div id="loginSection" style="display: none;">
                <div class="login-form">
                    <h2 class="login-title">üîë Administrator Login</h2>
                    <form id="loginForm" onsubmit="authenticateUser(event)">
                        <div class="form-group">
                            <label for="loginEmail">Email Address</label>
                            <input type="email" id="loginEmail" name="email" required placeholder="Enter your email">
                        </div>
                        <div class="form-group">
                            <label for="loginPassword">Password</label>
                            <input type="password" id="loginPassword" name="password" required placeholder="Enter your password">
                        </div>
                        <button type="submit" class="btn" style="width: 100%;">Login</button>
                    </form>
                </div>
            </div>
            
            <!-- Main Content (if authenticated) -->
            <div id="mainContent">
                <!-- Tabs -->
                <div class="tabs">
                    <button class="tab active" onclick="showTab('overview')">Overview</button>
                    <button class="tab" onclick="showTab('users')">User Management</button>
                    <button class="tab" onclick="showTab('permissions')">Permissions</button>
                    <button class="tab" onclick="showTab('audit')">Audit Log</button>
                    <button class="tab" onclick="showTab('security')">Security Settings</button>
                </div>
                
                <!-- Overview Tab -->
                <div id="overview" class="tab-content active">
                    <h2>üìä Security Overview</h2>
                    
                    <div class="security-stats">
                        <div class="stat-card">
                            <div class="stat-value" id="totalUsers">0</div>
                            <div class="stat-label">Total Users</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="activeUsers">0</div>
                            <div class="stat-label">Active Users</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="activeSessions">0</div>
                            <div class="stat-label">Active Sessions</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="securityEvents">0</div>
                            <div class="stat-label">Security Events (24h)</div>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3>üîç Quick Actions</h3>
                        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                            <button class="btn" onclick="refreshStats()">Refresh Stats</button>
                            <button class="btn btn-warning" onclick="viewActiveSessions()">View Active Sessions</button>
                            <button class="btn btn-danger" onclick="forceLogoutAll()">Force Logout All</button>
                            <button class="btn btn-secondary" onclick="exportAuditLog()">Export Audit Log</button>
                        </div>
                    </div>
                </div>
                
                <!-- User Management Tab -->
                <div id="users" class="tab-content">
                    <h2>üë• User Management</h2>
                    
                    <div class="form-section">
                        <h3>Create New User</h3>
                        <form id="createUserForm" onsubmit="createUser(event)">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="userEmail">Email Address <span style="color: #e74c3c;">*</span></label>
                                    <input type="email" id="userEmail" name="email" required placeholder="user@college.edu">
                                </div>
                                <div class="form-group">
                                    <label for="userFullName">Full Name <span style="color: #e74c3c;">*</span></label>
                                    <input type="text" id="userFullName" name="fullName" required placeholder="John Doe">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="userRole">Role <span style="color: #e74c3c;">*</span></label>
                                    <select id="userRole" name="role" required>
                                        <option value="">Select Role</option>
                                        <option value="ADMIN">Admin</option>
                                        <option value="ADMISSIONS">Admissions</option>
                                        <option value="FINANCE">Finance</option>
                                        <option value="HOSTEL">Hostel</option>
                                        <option value="EXAMINATION">Examination</option>
                                        <option value="FACULTY">Faculty</option>
                                        <option value="STUDENT">Student</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="userDepartment">Department</label>
                                    <input type="text" id="userDepartment" name="department" placeholder="Computer Science">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="userPassword">Password <span style="color: #e74c3c;">*</span></label>
                                <input type="password" id="userPassword" name="password" required placeholder="Minimum 8 characters">
                            </div>
                            
                            <button type="submit" class="btn btn-success">Create User</button>
                        </form>
                    </div>
                    
                    <div class="form-section">
                        <h3>User List</h3>
                        <button class="btn" onclick="loadUsers()">Refresh Users</button>
                        
                        <table class="table" id="usersTable">
                            <thead>
                                <tr>
                                    <th>User ID</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Role</th>
                                    <th>Department</th>
                                    <th>Status</th>
                                    <th>Last Login</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- User data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Permissions Tab -->
                <div id="permissions" class="tab-content">
                    <h2>üîë Role Permissions</h2>
                    
                    <div class="form-section">
                        <h3>Role Overview</h3>
                        <div class="permissions-grid" id="rolePermissions">
                            <!-- Role permissions will be populated here -->
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3>Update User Permissions</h3>
                        <form id="updatePermissionsForm" onsubmit="updateUserPermissions(event)">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="updateUserId">Select User</label>
                                    <select id="updateUserId" name="userId" required>
                                        <option value="">Select User</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="newRole">New Role</label>
                                    <select id="newRole" name="newRole" required>
                                        <option value="">Select Role</option>
                                        <option value="ADMIN">Admin</option>
                                        <option value="ADMISSIONS">Admissions</option>
                                        <option value="FINANCE">Finance</option>
                                        <option value="HOSTEL">Hostel</option>
                                        <option value="EXAMINATION">Examination</option>
                                        <option value="FACULTY">Faculty</option>
                                        <option value="STUDENT">Student</option>
                                    </select>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-warning">Update Permissions</button>
                        </form>
                    </div>
                </div>
                
                <!-- Audit Log Tab -->
                <div id="audit" class="tab-content">
                    <h2>üìã Security Audit Log</h2>
                    
                    <div class="form-section">
                        <h3>Filter Audit Log</h3>
                        <form id="auditFilterForm" onsubmit="filterAuditLog(event)">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="filterAction">Action</label>
                                    <select id="filterAction" name="action">
                                        <option value="">All Actions</option>
                                        <option value="LOGIN_SUCCESS">Login Success</option>
                                        <option value="LOGIN_FAILED">Login Failed</option>
                                        <option value="LOGOUT">Logout</option>
                                        <option value="USER_CREATED">User Created</option>
                                        <option value="PERMISSIONS_UPDATED">Permissions Updated</option>
                                        <option value="PERMISSION_DENIED">Permission Denied</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="filterUserId">User ID</label>
                                    <input type="text" id="filterUserId" name="userId" placeholder="Enter User ID">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="filterStartDate">Start Date</label>
                                    <input type="date" id="filterStartDate" name="startDate">
                                </div>
                                <div class="form-group">
                                    <label for="filterEndDate">End Date</label>
                                    <input type="date" id="filterEndDate" name="endDate">
                                </div>
                            </div>
                            
                            <button type="submit" class="btn">Filter Log</button>
                        </form>
                    </div>
                    
                    <div class="form-section">
                        <h3>Audit Log Entries</h3>
                        <table class="table" id="auditTable">
                            <thead>
                                <tr>
                                    <th>Timestamp</th>
                                    <th>Action</th>
                                    <th>User ID</th>
                                    <th>Description</th>
                                    <th>IP Address</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Audit log data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Security Settings Tab -->
                <div id="security" class="tab-content">
                    <h2>‚öôÔ∏è Security Settings</h2>
                    
                    <div class="form-section">
                        <h3>Session Management</h3>
                        <form id="securitySettingsForm" onsubmit="updateSecuritySettings(event)">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="sessionTimeout">Session Timeout (minutes)</label>
                                    <input type="number" id="sessionTimeout" name="sessionTimeout" value="30" min="5" max="480">
                                </div>
                                <div class="form-group">
                                    <label for="maxLoginAttempts">Max Login Attempts</label>
                                    <input type="number" id="maxLoginAttempts" name="maxLoginAttempts" value="5" min="3" max="10">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="passwordMinLength">Minimum Password Length</label>
                                    <input type="number" id="passwordMinLength" name="passwordMinLength" value="8" min="6" max="20">
                                </div>
                                <div class="form-group">
                                    <label for="requireStrongPassword">Require Strong Password</label>
                                    <select id="requireStrongPassword" name="requireStrongPassword">
                                        <option value="true">Yes</option>
                                        <option value="false">No</option>
                                    </select>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-success">Update Settings</button>
                        </form>
                    </div>
                    
                    <div class="form-section">
                        <h3>System Security</h3>
                        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                            <button class="btn btn-warning" onclick="generateSecurityReport()">Generate Security Report</button>
                            <button class="btn btn-danger" onclick="resetAllPasswords()">Reset All Passwords</button>
                            <button class="btn btn-secondary" onclick="backupSecurityData()">Backup Security Data</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Loading -->
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Processing request...</p>
            </div>
        </div>
    </div>
    
    <script>
        let currentSession = null;
        let userRoles = {
            'ADMIN': { name: 'Admin', permissions: ['read', 'write', 'delete', 'admin', 'user_management', 'system_config'] },
            'ADMISSIONS': { name: 'Admissions', permissions: ['read', 'write', 'student_management', 'application_processing'] },
            'FINANCE': { name: 'Finance', permissions: ['read', 'write', 'fee_management', 'payment_processing', 'receipt_generation'] },
            'HOSTEL': { name: 'Hostel', permissions: ['read', 'write', 'hostel_management', 'room_allocation'] },
            'EXAMINATION': { name: 'Examination', permissions: ['read', 'write', 'exam_management', 'grade_processing', 'transcript_generation'] },
            'FACULTY': { name: 'Faculty', permissions: ['read', 'write', 'student_records', 'grade_entry'] },
            'STUDENT': { name: 'Student', permissions: ['read', 'own_data'] }
        };
        
        // Tab switching
        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
            
            // Load data for specific tabs
            if (tabName === 'overview') {
                loadSecurityOverview();
            } else if (tabName === 'users') {
                loadUsers();
            } else if (tabName === 'permissions') {
                loadRolePermissions();
            } else if (tabName === 'audit') {
                loadAuditLog();
            }
        }
        
        // Authentication
        function authenticateUser(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const email = formData.get('email');
            const password = formData.get('password');
            
            showLoading();
            
            // Simulate API call
            setTimeout(() => {
                hideLoading();
                
                // Mock authentication
                if (email === 'admin@college.edu' && password === 'admin123') {
                    currentSession = {
                        sessionId: 'SES' + Date.now(),
                        user: {
                            id: 'USR001',
                            email: email,
                            fullName: 'System Administrator',
                            role: 'ADMIN',
                            permissions: userRoles.ADMIN.permissions
                        }
                    };
                    
                    showMainContent();
                    showAlert('Login successful!', 'success');
                } else {
                    showAlert('Invalid credentials. Please try again.', 'error');
                }
                
            }, 2000);
        }
        
        // Show main content
        function showMainContent() {
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('mainContent').style.display = 'block';
            loadSecurityOverview();
        }
        
        // Load security overview
        function loadSecurityOverview() {
            // Simulate API call
            setTimeout(() => {
                document.getElementById('totalUsers').textContent = '25';
                document.getElementById('activeUsers').textContent = '23';
                document.getElementById('activeSessions').textContent = '18';
                document.getElementById('securityEvents').textContent = '45';
            }, 1000);
        }
        
        // Load users
        function loadUsers() {
            showLoading();
            
            // Simulate API call
            setTimeout(() => {
                hideLoading();
                
                const users = [
                    { id: 'USR001', name: 'System Administrator', email: 'admin@college.edu', role: 'ADMIN', department: 'IT', status: 'Active', lastLogin: '2024-01-15 10:30' },
                    { id: 'USR002', name: 'John Smith', email: 'john.smith@college.edu', role: 'ADMISSIONS', department: 'Admissions', status: 'Active', lastLogin: '2024-01-15 09:15' },
                    { id: 'USR003', name: 'Jane Doe', email: 'jane.doe@college.edu', role: 'FINANCE', department: 'Finance', status: 'Active', lastLogin: '2024-01-15 08:45' },
                    { id: 'USR004', name: 'Mike Johnson', email: 'mike.johnson@college.edu', role: 'HOSTEL', department: 'Hostel', status: 'Active', lastLogin: '2024-01-14 16:20' },
                    { id: 'USR005', name: 'Sarah Wilson', email: 'sarah.wilson@college.edu', role: 'EXAMINATION', department: 'Examinations', status: 'Inactive', lastLogin: '2024-01-10 14:30' }
                ];
                
                const tbody = document.querySelector('#usersTable tbody');
                tbody.innerHTML = users.map(user => `
                    <tr>
                        <td>${user.id}</td>
                        <td>${user.name}</td>
                        <td>${user.email}</td>
                        <td><span class="role-badge">${userRoles[user.role].name}</span></td>
                        <td>${user.department}</td>
                        <td><span class="status-badge status-${user.status.toLowerCase()}">${user.status}</span></td>
                        <td>${user.lastLogin}</td>
                        <td>
                            <button class="btn btn-secondary" onclick="editUser('${user.id}')" style="padding: 5px 10px; font-size: 12px;">Edit</button>
                            <button class="btn btn-danger" onclick="deactivateUser('${user.id}')" style="padding: 5px 10px; font-size: 12px;">Deactivate</button>
                        </td>
                    </tr>
                `).join('');
                
                // Update user dropdowns
                updateUserDropdowns(users);
                
            }, 1000);
        }
        
        // Update user dropdowns
        function updateUserDropdowns(users) {
            const updateUserIdSelect = document.getElementById('updateUserId');
            updateUserIdSelect.innerHTML = '<option value="">Select User</option>' + 
                users.map(user => `<option value="${user.id}">${user.name} (${user.email})</option>`).join('');
        }
        
        // Load role permissions
        function loadRolePermissions() {
            const container = document.getElementById('rolePermissions');
            
            container.innerHTML = Object.keys(userRoles).map(roleKey => {
                const role = userRoles[roleKey];
                return `
                    <div class="permission-item enabled">
                        <div class="permission-title">${role.name}</div>
                        <div class="permission-description">
                            ${role.permissions.length} permissions<br>
                            ${role.permissions.join(', ')}
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        // Load audit log
        function loadAuditLog() {
            showLoading();
            
            // Simulate API call
            setTimeout(() => {
                hideLoading();
                
                const auditLogs = [
                    { timestamp: '2024-01-15 10:30:15', action: 'LOGIN_SUCCESS', userId: 'USR001', description: 'User logged in', ipAddress: '192.168.1.100' },
                    { timestamp: '2024-01-15 10:25:30', action: 'USER_CREATED', userId: 'USR002', description: 'New user created', ipAddress: '192.168.1.100' },
                    { timestamp: '2024-01-15 10:20:45', action: 'PERMISSIONS_UPDATED', userId: 'USR003', description: 'User permissions updated', ipAddress: '192.168.1.100' },
                    { timestamp: '2024-01-15 10:15:20', action: 'LOGIN_FAILED', userId: 'UNKNOWN', description: 'Failed login attempt', ipAddress: '192.168.1.101' },
                    { timestamp: '2024-01-15 10:10:10', action: 'LOGOUT', userId: 'USR004', description: 'User logged out', ipAddress: '192.168.1.102' }
                ];
                
                const tbody = document.querySelector('#auditTable tbody');
                tbody.innerHTML = auditLogs.map(log => `
                    <tr>
                        <td>${log.timestamp}</td>
                        <td>${log.action}</td>
                        <td>${log.userId}</td>
                        <td>${log.description}</td>
                        <td>${log.ipAddress}</td>
                    </tr>
                `).join('');
                
            }, 1000);
        }
        
        // Create user
        function createUser(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const userData = {
                email: formData.get('email'),
                fullName: formData.get('fullName'),
                role: formData.get('role'),
                department: formData.get('department'),
                password: formData.get('password')
            };
            
            showLoading();
            
            // Simulate API call
            setTimeout(() => {
                hideLoading();
                showAlert('User created successfully!', 'success');
                event.target.reset();
                loadUsers();
            }, 2000);
        }
        
        // Update user permissions
        function updateUserPermissions(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const userId = formData.get('userId');
            const newRole = formData.get('newRole');
            
            showLoading();
            
            // Simulate API call
            setTimeout(() => {
                hideLoading();
                showAlert('User permissions updated successfully!', 'success');
                event.target.reset();
                loadUsers();
            }, 2000);
        }
        
        // Filter audit log
        function filterAuditLog(event) {
            event.preventDefault();
            showLoading();
            
            // Simulate API call
            setTimeout(() => {
                hideLoading();
                showAlert('Audit log filtered successfully!', 'success');
                loadAuditLog();
            }, 1000);
        }
        
        // Update security settings
        function updateSecuritySettings(event) {
            event.preventDefault();
            showLoading();
            
            // Simulate API call
            setTimeout(() => {
                hideLoading();
                showAlert('Security settings updated successfully!', 'success');
            }, 2000);
        }
        
        // Utility functions
        function showLoading() {
            document.getElementById('loading').style.display = 'block';
        }
        
        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
        }
        
        function showAlert(message, type) {
            const alert = document.getElementById('alert');
            alert.textContent = message;
            alert.className = `alert ${type}`;
            alert.style.display = 'block';
            
            setTimeout(() => {
                alert.style.display = 'none';
            }, 5000);
        }
        
        function refreshStats() {
            showAlert('Statistics refreshed!', 'success');
            loadSecurityOverview();
        }
        
        function viewActiveSessions() {
            alert('Active Sessions:\n\n- admin@college.edu (10:30 AM)\n- john.smith@college.edu (9:15 AM)\n- jane.doe@college.edu (8:45 AM)');
        }
        
        function forceLogoutAll() {
            if (confirm('Are you sure you want to force logout all users?')) {
                showAlert('All users have been logged out!', 'warning');
            }
        }
        
        function exportAuditLog() {
            alert('Audit log exported successfully!');
        }
        
        function editUser(userId) {
            alert(`Edit user ${userId} - This would open an edit form.`);
        }
        
        function deactivateUser(userId) {
            if (confirm('Are you sure you want to deactivate this user?')) {
                showAlert('User deactivated successfully!', 'warning');
                loadUsers();
            }
        }
        
        function generateSecurityReport() {
            alert('Security report generated successfully!');
        }
        
        function resetAllPasswords() {
            if (confirm('Are you sure you want to reset all user passwords? This will require all users to set new passwords on next login.')) {
                showAlert('All passwords have been reset!', 'warning');
            }
        }
        
        function backupSecurityData() {
            alert('Security data backup completed successfully!');
        }
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is already authenticated
            if (currentSession) {
                showMainContent();
            } else {
                document.getElementById('loginSection').style.display = 'block';
                document.getElementById('mainContent').style.display = 'none';
            }
        });
    </script>
</body>
</html>